; ===================== PlatformIO Project Configuration =====================
; Robust upload settings for ESP32 on flaky USB links
; Each line has comments explaining why it's here.

[env]
platform = espressif32@6.7.0                   ; ESP32 core
board = esp32dev                               ; generic dev board
framework = arduino                            ; (or espidf)

; ---- Flash stability tweaks ----
board_build.flash_mode = dio                   ; safer than qio on many clones
board_build.f_flash    = 40000000L             ; 40 MHz flash clock (reduce SI issues)
; board_upload.flash_size = 4MB                ; uncomment if your module is known 4MB

; ---- Upload over serial via esptool ----
upload_protocol = esptool                      ; serial uploader
upload_speed = 921600                          ; slow & robust (bump later if stable)
upload_resetmethod = default  ; use default (DTR/RTS)
upload_flags =
  --before
  default_reset
  --after
  hard_reset




; ---- Serial monitor settings ----
monitor_speed = 115200                         ; must match Serial.begin()
monitor_dtr = 0                                ; don't wiggle DTR when opening monitor
monitor_rts = 0                                ; don't wiggle RTS (prevents auto-resets)
; Optional: print timestamps in monitor (nice for debugging boot loops)
monitor_filters = time                         ; adds [HH:MM:SS.mmm] to each line

; ---- Library resolver ----
lib_ldf_mode = deep+                           ; resolve transitive headers
lib_deps =
  https://github.com/gr82morozr/esp32-common.git
  nrf24/RF24 @ ^1.4.11

; ===================== Per-port environments =====================

[env:comA]
upload_port = COM3
monitor_port = COM3


[env:comB]
upload_port = COM5
monitor_port = COM5
